<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/head :: head}"></head>
<body>
<div th:replace="~{fragments/navbar :: navbar(activeTab)}"></div>

<h2>Дневен прием</h2>
<div>
    <div>Калории: <b th:text="${totalCal}"></b> / <span th:text="${goalCalories}"></span> kcal</div>
    <div class="progress">
        <div class="progress-bar"
             th:style="'width:' + (${totalCal}*100/${goalCalories}) + '%;'"
             th:text="${#numbers.formatDecimal(totalCal, 0, 0)} + ' / ' + ${goalCalories} + ' kcal'"></div>
    </div>
    <div>Въглехидрати: <b th:text="${totalCarbs}"></b> / <span th:text="${goalCarbs}"></span> g</div>
    <div class="progress">
        <div class="progress-bar"
             th:style="'width:' + (${totalCarbs}*100/${goalCarbs}) + '%;'"
             th:text="${#numbers.formatDecimal(totalCarbs, 0, 0)} + ' / ' + ${goalCarbs} + ' g'"></div>
    </div>
    <div>Протеин: <b th:text="${totalProtein}"></b> / <span th:text="${goalProtein}"></span> g</div>
    <div class="progress">
        <div class="progress-bar"
             th:style="'width:' + (${totalProtein}*100/${goalProtein}) + '%;'"
             th:text="${#numbers.formatDecimal(totalProtein, 0, 0)} + ' / ' + ${goalProtein} + ' g'"></div>
    </div>
    <div>Мазнини: <b th:text="${totalFats}"></b> / <span th:text="${goalFats}"></span> g</div>
    <div class="progress">
        <div class="progress-bar"
             th:style="'width:' + (${totalFats}*100/${goalFats}) + '%;'"
             th:text="${#numbers.formatDecimal(totalFats, 0, 0)} + ' / ' + ${goalFats} + ' g'"></div>
    </div>
</div>

<h3>Добави храна:</h3>
<form th:action="@{/tracker/add}" method="post" th:object="${foodEntryDTO}">
    <input type="text" th:field="*{foodName}" placeholder="Храна"/>
    <input type="number" th:field="*{calories}" placeholder="Калории (100g)"/>
    <input type="number" th:field="*{carbs}" placeholder="Въглехидрати (100g)"/>
    <input type="number" th:field="*{protein}" placeholder="Протеин (100g)"/>
    <input type="number" th:field="*{fats}" placeholder="Мазнини (100g)"/>
    <input type="number" th:field="*{weightInGrams}" placeholder="Изядено (g)"/>
    <select th:field="*{mealTime}">
        <option th:value="BREAKFAST">Закуска</option>
        <option th:value="LUNCH">Обяд</option>
        <option th:value="DINNER">Вечеря</option>
        <option th:value="SNACK">Снак</option>
    </select>
    <button type="submit">Добави</button>
</form>

<div th:each="mealTime : ${mealTimes}">
    <h3 th:text="${mealTime}"></h3>
    <ul>
        <li th:each="entry : ${mealsMap[T(gainzpad.model.enums.MealTimeEnum).valueOf(mealTime)]}">
            <span th:text="${entry.foodName}"></span>
            (<span th:text="${entry.weightInGrams}"></span> g,
            <span th:text="${#numbers.formatDecimal(entry.calories * entry.weightInGrams / 100, 1, 1)}"></span> kcal,
            <span th:text="${#numbers.formatDecimal(entry.protein * entry.weightInGrams / 100, 1, 1)}"></span> g protein,
            <span th:text="${#numbers.formatDecimal(entry.carbs * entry.weightInGrams / 100, 1, 1)}"></span> g carbs,
            <span th:text="${#numbers.formatDecimal(entry.fats * entry.weightInGrams / 100, 1, 1)}"></span> g fat
        </li>
        <li th:if="${#lists.isEmpty(mealsMap[T(gainzpad.model.enums.MealTimeEnum).valueOf(mealTime)])}">
            No foods added.
        </li>
    </ul>
    <div>
        <b>Total for <span th:text="${mealTime}"></span>:</b>
        <span th:text="${macrosByMeal[mealTime] != null ? #numbers.formatDecimal(macrosByMeal[mealTime][0], 1, 'POINT') : 0}"></span> kcal,
        <span th:text="${macrosByMeal[mealTime] != null ? #numbers.formatDecimal(macrosByMeal[mealTime][2], 1, 'POINT') : 0}"></span> g protein,
        <span th:text="${macrosByMeal[mealTime] != null ? #numbers.formatDecimal(macrosByMeal[mealTime][1], 1, 'POINT') : 0}"></span> g carbs,
        <span th:text="${macrosByMeal[mealTime] != null ? #numbers.formatDecimal(macrosByMeal[mealTime][3], 1, 'POINT') : 0}"></span> g fat
    </div>
</div>





<div th:replace="~{fragments/bootstrap-js::bootstrap-js}"></div>
</body>
</html>
